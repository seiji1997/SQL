#SQL

###問題031
[customers]テーブルから][山]で始まって[子]で終わる名前[name]の顧客のレコードを全カラム取得してください。

###問題032
[customers]テーブルから、顧客をランダムに3人選択し、すべてのカラムを取得してください。

###問題033
[sales]テーブルから、[quantity]と[revenue]の相関係数を求めてください。結果テーブルは[corr]というカラム名としてください。

###問題034
[products]テーブルから、原価[cost]の標準偏差を求めてください。ただし、[products]テーブルはサンプルではなく、全数[母集団]と考えます。

###問題035
[sales]テーブルから、もっとも古い日付・時刻[date_time]を取得してください。カラム名は[oldest_datetime]とします。

###問題036
[sales]テーブルから、もっとも高額な[revenue]が記録されているレコードの[orderid][user_id][revenue]を取得してください。

###問題037
[sales]テーブルから、商品ID[product_id]が[5]で、販売金額[revenue]が8,000円を超えるレコードのすべてのカラムを取得し、[order_id]の小さい順に表示して
ください。

###問題038
[web_log]テーブルから、メディア[media]として[cpc]が最初に記録された[date_time]を取得してください。

###問題039
[sales]テーブルで、初めて値引き販売が記録された[date_time]を取得してください。

###問題040
[customers]テーブルから、最高齢の願客の誕生日[birthday]を取得してください。

###問題041
[product]テーブルから、[ゼリー]のカテゴリを除いたレコードの[cost】の分散を
求めてください。なお、データは全数[母集団]であり、サンプルではありません。結果テーブルのカラム名は[var_cost]とします。

###問題042
[sales]テーブルから、[3]でも[7]でも割り切れる[order_id]で注文をした顧客のうち、もっとも小さい[user_id]を取得してください

###問題043
[sales]テーブルに記録されているもっとも新しい日付[date_time]を取得してください。結果テーブルのカラム名は[newestdate]とし、YYYY-MM-DD形式で表示してください。

###問題044
[customers]テーブルから、]名前[name]が[子]で終わる]もっとも年齢が高い顧客のレコードを全カラム取得してください。

###問題045
[customers]テーブルのうち、誕生日[birthday]に会員登録をした願客が1人だけ
います。その顧客のレコードを全カラム取得してください。

###問題046
[customers]テーブルから、都道府県[prefecture]が[福岡][佐賀][長崎]のいずれかに該当するプレミアム顧客のリストを全カラム取得してください。結果テーブルは[user_id]の小さい順に並べ替えて表示します。

###問題047
[sales]テーブルから、2017年2月1日から2月10日までの期間で、もっとも販売金額[revenue]が大きいレコードを全カラム取得してください。

###問題048
テーブルから、姓が[山]で終わる男性顧客の顧客ID[user_id]と氏名[name]を取得してください。

###問題049
[customers]テーブルに登録されている顧客の中に1人だけ、誕生日[birthday]は[null]だが、会員登録日[register_date]は判明している人がいます。その顧客の名前
[name]、誕生日[birthday]、会員登録日[register_date]を取得してください。

###問題050
[products]テーブルのうち、カテゴリ[product_category]は[クッキー]だが、商品名[productname]が[クッキー]で終わらないレコードを全カラム取得してください。

###問題051
[customers」テーブルから、もっとも若い顧客の「現在の年齢」を求めてください。結果テーブルのカラム名は[current_age】とします。


###問題052
[customers」テーブルに記録されている最年少の顧客は、2019年12月31日時点で何歳か求めてください。結果テーブルのカラム名は[youngestagelとします。


###問題053
「products]テーブルから、商品カテゴリ[product_category]と商品名[product_name]をハイフンでつないだ文字列[例:ケーキーレアチーズケーキ]を表示する[cat_prod」カラムと[cost」カラムを取得してください。結果テーブルは[cost」の高い順に3レコードだけ表示します。


###問題054
[sales]テーブルから、商品ID[product_id]が「7」「9」「11」のいずれかで、販売個数[quantity]が「2」以上、かつ、値引販売されているレコードを取得してください。結果テーブルは[order_id」の小さい順に並べ替えて、全カラムを取得します。


###問題055
[customers]テーブルから、月曜日に生まれた、もっとも年齢の高い顧客について、顧客ID[user_id]、氏名[name]、誕生日[birthday]を取得してください。


###問題056
「customers]テーブルから、「川」で始まる顧客名[username]と、誕生日[birthday]を取得してください。結果テーブルは年齢の高い順に並べ替え、上位3人に絞り込んで表示してください。


###問題057
[sales」テーブルから、1月1日に販売された注文をすべて取得してください。全カラムを取得し、並べ替えは[order_id」の小さい順とします。


###問題058
[customers」テーブルから、氏名[name]の後ろにその顧客が男性ならば「様」、女性ならば「さま」という文字列を付与したカラム[name_sama」を取得してください。結果テーブルは登録日[register_date]の新しい順に、5人の顧客に絞り込んで表示してください。


###問題059
[products]テーブルから、商品名[product_name]の未尾が「ゼリー」で終わっている場合、「ゼリー」を「ジュレ」に変更して、[modified_name」というカラム名で取得してください。結果テーブルは、元の商品名である「product_namelと、[modified_name]の2カラムとします。


###問題060
[customers」テーブルから、姓も名も3文字の顧客のリストを取得してください。結果テーブルは[user_id」と[name」の2カラムとします。


###問題061
[weblog]テーブルの[pagelカラムに記録されたWebページのうち、クエリパラメータ「?sys=abc123」が付与されているものがあります。分析に不向きなことがあるため、クエリパラメータを削除した文字列をクエリパラメータ除外ページ[page_withoutparameter]として取得してください。結果テーブルは、元のWebページ名を格納する[page]と、クエリパラメータを削除した[pagewithoutparameter」の2カラムとします。元の[page」がクエリパラメータ付きであったWebページに絞り込み、[datetime」の小さい順に3レコードだけ表示してください。

###問題062
[webloglテーブルの[page]カラムに格納されている「/prod/prodid[数字]/」の[数字部分は、商品ID[product_id]を示しています。[page】から[数字]だけを抜き出し、「productid]カラムとして取得してください。結果テーブルは[page」と[product_id]の2カラムとし、[date_time」の小さい順に並べ替えて、5レコードに絞り込んで表示します。


###問題063
[products]テーブルから、商品カテゴリ[product_category]と商品名[product_name]をハイフンでつないだ文字列[例:「ケーキーレアチーズケーキ」]を[cat_prod]カラムとして、また、その文字列の長さを「length]というカラム名で取得してください。結果テーブルは「length]の長い順に3レコードに絞り込んで表示します。


###問題064
[customers」テーブルから[namel[prefecturel[register_datel、そして登録日から10年後の日付を[aniversary10]カラムとして取得してください。ただし、都道府県[prefecture]が「千葉」の男性で、登録日[register_date]が「null」でない顧客に絞り込んでください。並べ替えは登録日の古い順とします。

###問題065
「customers」テーブルから、会員登録したときの年齢がもっとも若い顧客について、願客D[user_id]、氏名[name]、誕生日[birthday]、会員登錄日[register_date]、会員登録時年齢[register_age]を取得してください。


###問題066
[web_logl]テーブルから、Webサイトのページビュー数を求めてください。


###問題067
[products]テーブルから、原価[cost]の平均金額を求めてください。カラム名は[avg_cost]とします。


###問題068
[products]テーブルから、原価[cost]の最高金額[最大値]を求めてください。カラム名は[max_cost」とします。


###問題069
「sales]テーブルから、最大の販売金額[revenue]を求めてください。カラム名は[max_revenuelとします。

###問題070
「sales]テーブル全体の販売金額[revenue]の合計を求めてください。


###問題071
「sales]テーブル全体の販売個数[quantity]の合計を求めてください。カラム名は[sum_quantity]とします。


###問題072
[weblog]テーブル全体のユーザー数を求めてください。ユーザーは固有の[cid」で判定します。カラム名は[users」とします。


###問題073
[sales」テーブル全体のユニークな注文数を求めてください。カラム名は[orders]とします。

###問題074
[sales]テーブル全体で、何人の顧客に対して販売しているかを求めてください。カラム名は[users」とします。


###問題075
[web_log]テーブルから[date_time」の最大値を教えてください。


###問題076
「sales」テーブル全体で、何種類の商品[product_id]が販売されているかを求めてください。カラム名は「items」とします。


###問題077
[sales」テーブルに記録されている販売金額[revenue]の金額が税込だったとします。テーブル全体の[revenue」の合計が税抜でいくらになるか、求めてください。消費税率
は期間全体で10%とします。結果テーブルのカラム名は[revenue_without_tax]としてください。


###問題078
[weblog]テーブルに記録されているユニークな[media」の個数を求めてください。結果テーブルは[number_of_media]というカラム名で取得します。


###問題079
[sales」テーブルから、商品ID[productid]が「1」の商品の販売金額[revenue]の合計を求めてください。結果テーブルは[sumrevenue_1]というカラム名とします。


###問題080
[web_log]テーブルから[session_count]が「1」[新規訪問]のページビュー数の合計を求めてください。結果テーブルのカラム名は[pv_new_visit]とします。


###問題081
[products]テーブルにユニークな商品カテゴリ[productcateqory]がいくつあるか求めてください。結果テーブルのカラム名は[categories]とします。


###問題082
[products]テーブルから、原価[cost]が300円以下の商品の個数を求めてください。結果テーブルのカラム名は「items」とします。


###問題083
[sales]テーブルから、販売金額[revenue]合計を全願客数で割って、顧客の平均販売金額を求めてください。結果テーブルのカラム名は[avg_rev_by_user]とします。


###問題084
[weblog]テーブルの最大の[datetime」から最小の「datetime」を差し引いて、期間を日単位で表示してください。結果テーブルのカラム名は[days」とします。


###問題085
[web_loglテーブルから、デバイス別のページビュー数を求めて下さい。結果テーブルは[device」[pageviews」の2カラムとし、[pageviews」の降順に並べ替えて表示してください。


###問題086
「customerslテーブルに都道府県[brefecture]が「東京」以外ので安は何人いるか調べてください。結果テーブルのカラム名は[users]とします。


###問題087
[customers」テーブルで、会員登録日[register_date]が「null」の顧客の人数を求めてください。結果テーブルのカラム名は[users]とします。


###問題088
[web_log]テーブルに、何日の固有な日が記録されているかを調べてください。結果テーブルのカラム名を[unique_days]とします。


###問題089
「webloalテーブルから、ページ[page]別のページビュー数を取得し、ページビュー数の多い順に、トップ5のページ[page]を表示してください。パラメータ「?sys=abc123」が付いているページと、付いていないページは区別して集計します。結果テーブルは[page」と[pageviews]の2カラムとします。

###問題090
「webloalテーブルに記録された「/prod/prodid8/」のページビュー数を求めてください。クエリパラメータ「?sys=abc123」の有無にかかわらずカウントします。結果テーブルのカラム名は[pageviews_8]とします。


###問題091
「saleslテーブルから、商品ID[productid]が「14」もしくは「15」の商品の販売個数[quantity]の合計を求めてください。結果テーブルのカラム名は[sum_qty_14_15]とします。


###問題092
[sales」テーブルから、販売金額[revenue]の合計を注文数で割って、注文あたりの平均販売金額を求めてください。結果テーブルのカラム名は[avg_revbyorder」とします。[avg_rev_by_order」は十の位で切り捨て、百円単位に丸めます。


###問題093
[sales]テーブルから、もっとも高額な注文[order_id]とその注文の販売金額[revenue]の合計[sumrev]を取得してください。結果テーブルのカラムは「orderid」と[sum_rev」の2カラムとします。


###問題094
[sales]テーブルに記録されている販売金額[revenue]が税抜だったとします。テーブル全体の[revenue」が税込でいくらになるか求めてください。消費税率は、2019年10月1日以前は8%、以降は10%とします。カラム名は[revenue_with_tax]とします。


###問題095
「sales]テーブルに記録された2019年の販売金額[revenue]の合計を求めてください。結果テーブルのカラム名は[sum_revenue_2019]とします。


###問題096
HINT■3-2,4-2
[products]テーブルから、原価[cost]別に商品の個数を取得してください。結果テーブルは[cost]と商品数[number_of_products」の2カラムとします。なお、原価[cost]
が500円未満の商品に絞り込んで表示してください。


###問題097
[customers」テーブルの誕生日[birthday]も、会員登録日[register_date]も「null」の顧客は何人いるか求めてください。結果テーブルのカラム名は[users」とします。


###問題098
「webloalテーブルに記録されたWebページ[page]が、「/prod/prodid[数字]/に該当するページビュー数を求めてください。「数字」は「1」から「15」まで存在します。結果テーブルのカラム名は[pageviews_prod]とします。なお、ページには「/prod/prodid/15/?sys=abc123のように、末尾に「?sys=123」が存在している場合があります。そのページはカウントしないでください。

###問題099
[sales」テーブルから「年」を問わず、1月と12月に販売された注文の個数を取得してください。結果テーブルのカラム名は[orders」とします。


###問題100
[customers]テーブルから、1980年代生まれの顧客の数を求めてください。カラム名は[users」とします。


###問題101
「customers]テーブルから、都道府県別の顧客数を求めてください。結果テーブルは都道府県[prefecture]、顧客の数[users]の2カラムとします。絞り込みは顧客数の
多い順に3レコードとしてください。


###問題102
[customers」テーブルに記録されている、2019年第1四半期に会員登録を行った顧客数を求めてください。結果テーブルのカラム名は[users]とします。なお、第1四半期
は1~3月とします。


###問題103
[sales]テーブルから、販売金額[revenue]の合計をユニークな「日」[date_time]の数で割り、日別の平均売上金額を求めてください。結果テーブルのカラム名は[avg_rev_by_day]とします。[avg_rev_by_day]は十の位で切り上げして百円単位に丸めて表示してください。


###問題104
[sales」テーブルを対象に、販売された時間を「年」と「午前または午後」でグループ化したときの販売金額を表示してください。結果テーブルは、「2017-AM]から「2019-PM]までの6つの値を持つ[sales_time」と、それらのグループごとの販売金額の合計[sumrev]の2カラムとしてください。


###問題105
[customers」テーブルから、都道府県[prefecture]が千葉県の女性顧客の平均年齢を求めてください。年齢は2019年12月31日時点の満年齢とします。結果テーブルのカラム名は[avg_age」とします。


###問題106
[sales」テーブルにて、商品ID[product_id]が「1」、個数[quantity]が「1」で値引販売されたレコードは記録ミスだということが判明しました。実際には、それらのレコードは定価である1個あたり2,000円で販売されていました。販売金額[revenue]を修正し、テーブル全体の販売金額の合計を取得してください。結果テーブルのカラム名は[modified_sumrev」とします。


###問題107
[products」テーブルから、商品カテゴリ[product_category]ごとの原価[cost]の平均を求めてください。平均原価[avg_cost]は整数型[INT64型]に変換し、金額の大きい順に表示してください。


###問題108
[sales」テーブルから、2019年に販売された商品ID[product_id]が「5」の商品の販売金額[revenue]の合計はいくらか求めてください。カラム名は[sum_revenue_5_2019]
とします。


###問題109
[sales」テーブルから、年ごとの平均の販売個数を求めてください。結果テーブルは「vear」と「avaaty]の2カラムとします。[avgaty]は四捨五入で小数点以下第2位ま
で表示してください。


###問題110
[sales]テーブルから、販売した年別の顧客数を求めてください。結果テーブルは、年[year]と願客数[users]の2カラムとして、年の昇順に並べ替えます。


###問題111
[we_log]テーブルのうち、日別のページビュー数でトップ3を求めてください。結果テーブルは、日付[date]とページビュー[paqeviews]の2カラムとしてください。


###問題112



###問題113



###問題114



###問題115



###問題116



###問題117



###問題118



###問題119



###問題120



###問題121



###問題122



###問題123



###問題124



###問題125



###問題126



###問題127



###問題128



###問題129



###問題130



###問題131



###問題132



###問題133



###問題134



###問題135



###問題136



###問題137



###問題138



###問題139



###問題140



###問題141



###問題142



###問題143



###問題144



###問題145



###問題146



###問題147



###問題148



###問題149



###問題150



###問題151



###問題152



###問題153



###問題154



###問題155



###問題156



###問題157



###問題158



###問題159



###問題160



###問題161



###問題162



###問題163



###問題164



###問題165



###問題166



###問題167



###問題168



###問題169



###問題170



###問題171



###問題172



###問題173



###問題174



###問題175



###問題176



###問題177



###問題178



###問題179



###問題180



###問題181



###問題182



###問題183



###問題184



###問題185



###問題186



###問題187



###問題188



###問題189



###問題190



###問題191



###問題192



###問題193



###問題194



###問題195



###問題196



###問題197



###問題198



###問題199



###問題200



###問題201



###問題202



###問題203



###問題204



###問題205



###問題206



###問題207



###問題208



###問題209



###問題210



###問題211



###問題212



###問題213



###問題214



###問題215



###問題216



###問題217



###問題218



###問題219



###問題220



###問題221



###問題222



###問題223



###問題224



###問題225



###問題226



###問題227



###問題228



###問題229



###問題230



